---
layout: post
title:  "2019 ACM-ICPC Seoul Regional 풀이"
author: ho94949
date: 2019-11-14 15:00
tags: [ACMICPC, Regional]
---

# 서론

2019년 2019년 11월 9일 토요일에 ACM-ICPC 서울 리저널이 진행 되었다. 대회에 대한 정보는 [http://icpckorea.org](http://icpckorea.org) 에서 찾아볼 수 있다. (학교 기준으로) 1등은 모든 문제를 해결한 서울대학교의 Cafe Mountain, 2등은 9문제를 패널티 1004분으로 해결한 연세대학교의 Inseop is Korea top, 3등은 9문제를 패널티 1464분으로 해결한 KAIST의 CMD이다.

올해에는 12문제가 출제 되었고, 이 문제들에 대한 풀이를 작성해보려고 한다.

# A - Fire on Field

## 문제

$$A[0] = 1, A[1] = 1$$ 이고, 2 이상의 $$i$$에 대해, $$A[i]$$ 를 모든 가능한 $$k > 0, i - 2k \ge 0$$ 을 만족하는 $$k$$에 대해서, $$A[i], A[i-k], A[i-2k]$$가 등차수열이 되지 않도록 하는 (즉, $$A[i]-A[i-k] \neq A[i-k] - A[i-2k]$$) 최소한의 값이라고 하자.

이 때 주어진 $$n$$에 대해서 $$A[n]$$을 구하여라. ($$0 \le n \le 1000$$)

## 풀이

문제에서 주어진 대로 구현을 하는 것이 기본 아이디어이다. 위의 항을 이항 하면, $$A[i] \neq 2A[i-k] - A[i-2k]$$ 가 된다. 각각 $$i$$에 대해서, 불가능한 $$A[i]$$에 값을 모두 구해 놓고, 1부터 올려가면서 가능한 값이 있는지 확인하면 된다. 이는 배열 접근 혹은 `std::set` 등을 이용하면 매우 쉽게 할 수 있다. 시간복잡도는 $$O(n^2)$$ 혹은 $$O(n^2 \log n)$$ 정도이다.

# B - Gene Tree

## 문제

모든 정점의 차수가 3 이하인 트리 $$T$$가 하나 주어진다. 이 트리의 두 개의 리프(차수가 1인 정점)의 순서 없는 쌍들에 대해, 거리 제곱의 합을 구하여라. 

좀 더 엄밀하게는, 트리 위의 두 정점 $$u$$와 $$v$$ 사이의 거리를 $$d(u, v)$$ 라고 하고 리프의 집합을 $$L$$ 이라고 할 때, $$\sum_{\{u, v\} \subset L} (d(u, v))^2$$ 을 구하여라.

($4 \le |T| \le 100,000$)

## 풀이

매우 잘 알려진 풀이가 여럿 있고, Centroid Decomposition을 사용하는 방법과, 트리 위에서 동적 계획법을 하는 크게 두 가지의 풀이가 있다. 이 게시글에서는 앞의 풀이를 설명하겠다.

트리의 리프가 아닌 아닌 정점 $$v$$에 대해, 두 리프를 잇는 경로가 $$v$$를 지나는 경우를 생각 해 보자. 이를 위해서 $$v$$를 루트로 하는 트리들과, 이 트리에서 $$v$$와 인접한 정점들을 루트로 하는 서브트리를 생각 해 보자. 어떤 두 리프를 잇는 경로가 $$v$$를 지난다는 말은, 서로 다른 서브트리에서 왔다는 뜻이다. 정점의 차수가 3 이하이므로, 모든 서로 다른 두 서브트리 사이에서 정점 $$v$$를 지나는 경우를 모두 고려해 주어도 3번 이하만 고려해 주면 된다.

[[사진: TBD]]

서브트리 $$T_1$$의 리프 $$x_i$$와 $$T_2$$의 리프 $$y_j$$사이의 거리는, $$d(x_i, y_j) = d(x_i, v_j) + d(v_i, y_j)$$ 이고, 이를 제곱 하면, $$d(x_i, y_j)^2 = (d(x_i, v)+d(v,y_j))^2 = d(x_i,v)^2+2d(x_i,v)d(v, y_j)+d(v,y_j)^2$$ 이다. 

$$T_1$$의 리프 갯수가 $$p$$, $$T_2$$의 리프 갯수는 $$q$$ 개라고 하면, 서브트리 $$T_1$$과 $$T_2$$ 사이에서의 거리의 제곱의 합을 써보면

$$V$$ = $$\sum_{i=1}^{p} \sum_{j=1}^{q} d(x_i,v)^2+2d(x_i,v)d(v, y_j)+d(v,y_j)^2$$ 

​    = $$\sum_{i=1}^{p} (q d(x_i,v)^2 + 2d(x_i,v) \sum_{j=1}^{q} d(v, y_j)+\sum_{j=1}^{q} d(v,y_j)^2)$$ ($$j$$와 무관한 항은 밖으로 꺼낼 수 있다.)

​    = $$p\sum_{j=1}^{q} d(v,y_j)^2 + q \sum_{i=1}^{p} d(x_i,v)^2 + 2\sum_{i=1}^{p} d(x_i,v) \sum_{j=1}^{q} d(v, y_j)$$ (마찬가지로, $$i$$와 무관한 항을 정리해준다.)

이 된다. 즉 우리는, 리프의 갯수와, 리프들의 거리의 합과, 리프들의 거리의 제곱의 합을 구해서 위의 수식을 통해 계산해 주면 된다. 이는 dfs를 통해 간단하게 $$O(|T|)$$ 시간에 진행할 수 있다.

이제, 우리는 정점 $$v$$를 지나는 경우를 고려해 주었으니까, 정점 $$v$$를 지나지 않는 경우를 고려해 주어야 하고, 이는 서브트리 내에서의 문제일 것이다. 즉, 우리는 이 문제에 대해서 분할정복을 사용 할 것이다. 걸리는 시간을 $$X$$라고 하면, $$X(T) = X(T_1) +X(T_2) + X(T_3) + O(|T|)$$ 이고, $$|T_1|+|T_2| + |T_3| = |T|-1$$ 이다. 여기서 각 트리의 크기가 $$|T|/2$$ 보다 작거나 같다면, 우리는 이러한 $$v$$를 centroid라고 할 것이고, 이 때의 시간 복잡도는 $$X(T) = O(|T| \log |T|)$$ 이 나올 것이다.  우리는 이러한 centroid는 무조건 존재함을 증명할 수 있다.

[[사진: TBD]]

- 명제) 모든 트리에 대해 centroid는 존재한다.
- 증명) 모든 가능한 정점 중에, 서브트리 중 가장 큰 트리의 정점 수가 가장 작은 정점을 $$v$$라고 할 것이고, 이 중 가장 큰 서브트리를 $$T_1$$ 이라고 하자. 만약 centroid가 존재하지 않는다면, $$|T_1| > |T|/2$$ 일 것이다. $$T_1$$의 루트를 $$w$$라고 하자. 이 경우에 $$w$$의 서브트리를 보면, 원래 $$T_1$$이었던 부분과, $$T_1$$이 아니였던 부분으로 나뉠 수 있다. 이 $$w$$의 모든 서브트리는 $$T_1$$ 보다 크기가 작으므로 가정에 모순이다. 
  - 원래 $$T_1$$이었던 부분 $$U_i$$는 $$T_1$$의 서브트리이기 때문에, $$T_1$$보다 크기가 작다. 
  - 원래 $$T_1$$이 아니었던 부분 $$V$$의 크기는 $$|V| = |T|-|T_1| < |T|-|T|/2 = |T|/2$$ 이므로 $$T_1$$ 보다 크기가 작다.

또한 이 centroid는 서브트리의 크기를 구해주는 동적계획법을 적용해서 간단하게 찾아줄 수 있다.

이 centroid를 통해서 분할정복으로 이 문제를 해결 할 수 있다.

시간 복잡도는 $$O(|T| \log |T|)$$ 이다.

# C - Islands

## 문제 

정수 $$n$$에 대해, 1 이상 $$n$$이하의 정수로 이루어진 두 순열 $$\{A_i\}$$와 $$\{B_i\}$$가 원 위에 주어진다. 우리는 어떠한 순열 $$\{C_i\}$$를 찾아야 하는데, 두 원에 $$C_1$$과 $$C_2$$를 잇는 선분, $$C_2$$와 $$C_3$$를 잇는 선분, ..., $$C_{n-1}$$과 $$C_n$$을 잇는 선분을 그렸을 때, 모든 원에 대해서 임의의 두 선분이 (양 끝점을 제외하고) 교차하면 안된다.

이러한 $$C_i$$가 존재하면 찾고, 존재하지 않으면 존재하지 않는다고 출력하여라.

[[그림: TBD]]

그림 설명: $$A = (1, 5, 2, 4, 6, 3), B = (3, 4, 5, 2, 6, 1), C = (3, 1, 6, 4, 5, 2)$$이다.

## 풀이

TBD

# D - Ladder Game

## 문제 

(원문은 사다리 타기이고, 지문이 잘못 쓰였기 때문에 엄밀하게 바꾸었다.)

길이 $$L$$의 $$1$$ 이상 $$n-1$$ 이하의 정수로 이루어진 수열 $$A$$ 가 주어진다. 우리는 순열 $$\pi_A$$ 를 다음과 같이 정의할 것이다:  $$\pi = (1, 2, \cdots, n)$$에서 시작하여, 총 $$L$$번의 단계로 순열을 섞는데, $$\pi$$의 $$A_i$$ 번째 원소와 $$A_{i+1}$$ 번째 원소를 섞는다.

수열 $$A$$의 부분 수열 $$B$$가 $$\pi_B = \pi_A$$를 만족 하면서, 어떤 다른 $$B$$의 부분 수열 $$C$$에 대해서도 $$\pi_C = \pi_B$$를 만족하지 않는 부분 수열 $$B$$를 우리는 "극소 순열" 이라고 할 것이다. 이러한 극소 수열을 아무거나 하나 찾아 출력하여라. ($$3 \le n \le 50, 0 \le L \le 25000$$, 실제 대회에 사용된 데이터는 $$n$$과 $$L$$이 작았다.)

## 풀이

어떤 순열 $$\pi$$의 inversion을 $$i < j$$ 이고 $$\pi_i > \pi_j$$인 순서쌍 $$(i, j)$$의 갯수라고 정의할 것이다. 인접한 두 원소를 교환하는 연산은 inversion을 1 증가시키거나 1 감소시킨다. 왜냐하면, $$(i, i+1)$$이 inversion에 포함되는지 안되는지의 여부가 달라지고 $$(*, i)$$의 순서쌍은 $$(*, i+1)$$ 로, $$(*, i+1)$$의 순서쌍은 $$(*, i)$$로 이동하기 때문이다.

 $$\pi_A$$를 만드는 $$A$$의 부분수열 $$B$$의 최소 길이는 $$\pi_A$$의 inversion의 갯수보다 크다 라는 사실을 알 수 있다. 한 번 순열을 섞을 때 inversion을 1씩밖에 증가시키지 못하기 때문이고, 원래 순열의 inversion은 0이기 때문이다.

이제 부분수열 $$B$$를 명시적으로 찾을 것이다. $$A$$에서 필요 없는 두 원소를 없애가면서 부분수열을 찾을 것이다. $$A$$에서 위와 같은 방법으로 $$\pi_A$$를 만들 때, inversion을 감소 시키는 수를 $$A_x$$라고 하자. (즉, $$x-1$$번 연산을 진행하고, $$\pi$$의 $$A_x$$번째 원소 $$L$$과 $$A_{x+1}$$번째 원소 $$R$$를 비교해 봤을 때, $$A_x$$번째 원소가 더 컸다고 하자.) 이후, 이전 과정에서 $$R$$과 $$L$$을 바꾼 적이 있었고, 이 둘을 제거한 부분 수열은 같은 $$\pi$$를 만든다.

원래 수열에서는, 작은 수가 항상 왼쪽에 있기 때문에 $$R$$이 왼쪽에 있고, $$L$$이 오른쪽에 있을 것이다. 섞는 일련의 과정에서 $$R$$이 오른쪽, $$L$$이 왼쪽으로 갔다는 뜻은 중간에 $$R$$과 $$L$$의 경로가 교차하는 $$A_y$$가 있었다는 뜻이다. $$A_y$$와 $$A_{y-1}$$의 차이는 $$L$$과 $$R$$이 바뀐 것이고, 이 이후 $$y+1$$번째 부터 $$x-1$$번째 연산까지 진행 해도, 두 수열은 $$L$$과 $$R$$만 바뀐 것이고, 추가로 $$x$$번째 연산을 시행 해 주면 $$L$$과 $$R$$이 두번 바뀌었기 때문에 원래 위치로 돌아오며, 같은 수열인 $$\pi$$를 만든다.

이 연산은 수열의 길이만큼 시행 할 수 있고, 찾는 시점은 inversion이 감소할 수 있는 시점인 $$n^2$$번째 시점이기 때문에 시간 복잡도는 $$O(n^2 \times L)$$ (문제에서는 $$O(n^2 \times nl)$$) 이다.

# E - Network Vulnerability

## 문제

그래프 $$G$$의 $$c_k(G)$$를, $$G$$에서 $$k$$개의 정점을 제거 했을때 나뉘어지는 그래프 연결 성분의 최대 갯수라고 정의 하자. 

구간 $$n$$개로 이루어진 구간 그래프 $$G$$가 주어졌을 때, $$c_1(G), c_2(G), \cdots, c_{n-1}(G)$$를 구하여라. 여기서 구간 그래프란, 각 구간을 하나의 정점으로 하며, 두 구간 $$x$$와 $$y$$가 교차하면 $$x$$와 $$y$$사이에 선분이 존재하는 그래프를 의미한다.

## 풀이

TBD

# F - Quadrilaterals

TBD

# G - Same Color

TBD

# H - Strike Zone

TBD

# I - Thread Knots

TBD

# J - Triangulation

TBD

# K - Wahser

TBD

# L - What's Mine is Mine